<!doctype html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

		<title>Functional Programming in F#</title>

		<link rel="stylesheet" href="css/reveal.css">
		<link rel="stylesheet" href="css/theme/simple.css">

		<!-- Theme used for syntax highlighting of code -->
		<link rel="stylesheet" href="lib/css/vs.css">

		<!-- Printing and PDF exports -->
		<script>
			var link = document.createElement( 'link' );
			link.rel = 'stylesheet';
			link.type = 'text/css';
			link.href = window.location.search.match( /print-pdf/gi ) ? 'css/print/pdf.css' : 'css/print/paper.css';
			document.getElementsByTagName( 'head' )[0].appendChild( link );
		</script>
	</head>
	<body>
		<div class="reveal">
			<div class="slides">
				<section>
					<h1>Functional Programming in F#</h1>
					<h2>Daniel Wallis</h2>
				</section>




				<section>
					<h1>About me</h1>
				</section>




				<section>
					<h1>What is Functional Programming?</h1>
					A <b>programming paradigm</b> that treats computation as the evaluation of mathematical functions and <b>avoids changing-state and mutable data</b>
				</section>				




				<section>
					<section>
						<h1>What are the benefits?</h1>
						<ul>
							<li class="fragment">Calling a function twice with the same arguments produces the same result</li>
							<li class="fragment">Immutability by default</li>
							<li class="fragment">No null checking</li>
							<li class="fragment">More concise syntax</li>
							<li class="fragment">Less boilerplate</li>
						</ul>
					</section>
					<section>
						<h1>Side note:</h1>
						<h3>Being concise isn't always good!</h3>
						<div class="fragment">
							What does this APL code do?!?
							<pre>
(~R∊R∘.×R)/R←1↓ιR
							</pre>
						</div>
						<div class="fragment">
							Answer: Finds all prime numbers from 1 to R
						</div>
					</section>
				</section>




				<section>
					<h1>Why F#?</h1>
					<ul>
						<li class="fragment">Familiar tooling</li>
						<li class="fragment">Interoperability with C#</li>
						<li class="fragment">Use of NuGet and other DLLs</li>
						<li class="fragment">Use of existing frameworks (e.g. ASP.NET MVC)</li>
						<li class="fragment">Can be used as scripting language</li>
					</ul>
				</section>




				<section>
					<h1>Show me the code!</h1>
					<div style="float:left;width:50%;">
						<pre><code class="fsharp hljs" data-trim>					
[&ltEntryPoint&gt]
let main argv =
    printfn "Hello, World!"
    0
						</code></pre>
						<div class="fragment">
							<pre><code class="fsharp hljs" data-trim>
type Person = {Name:string; Age:int;}

let MakePerson name =
    {Name=name; Age=0;}
							</code></pre>
							Equals and HashCode implemented by default!
						</div>				
					</div>
					<div style="float:right;width:50%;">
						<pre class="fragment"><code class="hljs" data-trim>	
public class Person
{
    public Person(string name, int age)
    {
        Name = name;
        Age = age;
    }

    public int Age { get; }

    public string Name { get; }

    public override bool Equals(object obj)
    {
        if (ReferenceEquals(null, obj)) return false;
        if (ReferenceEquals(this, obj)) return true;
        if (obj.GetType() != this.GetType()) return false;
        var other = (Person) obj;
        return Age == other.Age && string.Equals(Name, other.Name);
    }

    public override int GetHashCode()
    {
        unchecked
        {
            return (Age*397) ^ (Name?.GetHashCode() ?? 0);
        }
    }
}    
	    				</code></pre>
	    			</div>
				</section>




				<section>
					<h1>Show me the code!</h1>
					<pre><code class="fsharp hljs" data-trim>					
open System

type Person = {Name:string; Age:int;}

let MakePerson name =
    {Name=name; Age=0;}

// Create new person by just modifying the age
let GrowOlder person = 
    {person with Age=person.Age+1}

[&ltEntryPoint&gt]
let main argv =        
    printfn "Hello, World!"
    let person1 = {Name="Bob";Age=52;}
    let person2 = {Name="Bob";Age=52;}

    // Print to console in a type-safe way
    printfn "%i" (person1.GetHashCode())
    printfn "%i" (person2.GetHashCode())
    printfn "%b" (person1=person2)        
    
    Console.ReadKey() |> ignore
    0
					</code></pre>
				</section>




				<section>
					<h1>Show me the code!</h1>
					Tony Hoare (inventor of the null reference): 
					<blockquote>“I call it my billion-dollar mistake.
					<br/>…
					<br/>This has led to innumerable errors, vulnerabilities, and system crashes, which have probably caused a billion dollars of pain and damage in the last forty years.”
					</blockquote>	
				</section>



				
				<section>
					<h1>Show me the code!</h1>
					<pre><code class="fsharp hljs" data-trim>								
let PrintPerson person = 
    printfn "Name:%s, Age:%i" person.Name person.Age

let NullExample() = 
    PrintPerson null

let RealExample() = 
    PrintPerson {Name="Bob"; Age=52;}
					</code></pre>
					<div class="fragment">
						No nulls! (except when using standard .NET types)
						<pre>
The type 'Person' does not have 'null' as a proper value
						</pre>
					</div>
					<pre class="fragment"><code class="fsharp hljs" data-trim>								
let PrintPerson person =
    match person with
    | Some(p) -> printfn "%A" p
    | None -> printfn "No person given" 

let NullExample() = 
    PrintPerson None

let RealExample() =
    PrintPerson (Some({Name="Bob"; Age=52;}))
					</code></pre>
					<div class="fragment">
						Pretty printing built in
						<pre class="fragment"><code class="hljs nohighlight" data-trim>								
{Name = "Bob";
Age = 52;}
						</code></pre>
					</div>
				</section>




				<section>
					<h1>Show me the code!</h1>
					<h2>Union types</h2>
					<div style="float:left;width:50%;">
						<pre><code class="fsharp hljs" data-trim>	
namespace FSharp

open System

module Parser = 
    let TryParseInt value = 
        try
            Some(Int32.Parse value)
        with
        | _ -> None

    let ReadInt() = 
        let line = Console.ReadLine()
        match TryParseInt line with
        | Some(i) -> printfn "Successfully read integer: %i" i
        | None -> printfn "Failed to read integer"
						</code></pre>						
					</div>
					<div style="float:right;width:50%;">
						<pre><code class="hljs" data-trim>	
using System;

namespace CSharp
{
    public class Parser
    {
        public static bool TryParseInt(string value, out int i)
        {
            i = 0;

            try
            {
                i = int.Parse(value);
                return true;
            }
            catch (Exception)
            {
                return false;
            }
        }

        public static void ReadInt()
        {
            var line = Console.ReadLine();
            int i;
            if (TryParseInt(line, out i))
            {
                Console.WriteLine($"Successfully read integer: {i}");
            }
            else
            {
                Console.WriteLine("Failed to read integer");
            }
        }
    }
}
						</code></pre>						
					</div>
				</section>




				<section>
					<h1>Show me the code!</h1>
					<h2>Units of measure</h2>
					<pre><code class="fsharp hljs" data-trim>
[&ltMeasure&gt] type USD
[&ltMeasure&gt] type GBP					
					</code></pre>
					<pre class="fragment"><code class="fsharp hljs" data-trim>					
let AddAmounts (x:int&ltUSD&gt) (y:int&ltUSD&gt) = 
    x + y
					</code></pre>
					<pre class="fragment"><code class="fsharp hljs" data-trim>					
let TestAdder() = 
    AddAmounts 1&ltUSD&gt 2&ltUSD&gt
    				</code></pre>
    				<pre class="fragment"><code class="fsharp hljs" data-trim>					
let TestAdderInvalid() = 
    AddAmounts 1&ltUSD&gt 2
					</code></pre>
					<pre class="fragment">
This expression was expected to have type
<br/>int&ltUSD&gt
<br/>but here has type
int</pre>
					<pre class="fragment"><code class="fsharp hljs" data-trim>					
let TestAdderInvalid2() = 
    AddAmounts 1&ltUSD&gt 2&ltGBP&gt
					</code></pre>
					<pre class="fragment">
Type mismatch. Expecting a
<br/>int&ltUSD&gt
<br/>but given a
<br/>int&ltGBP&gt
<br/>The unit of measure 'USD' does not match the unit of measure 'GBP'</pre>
					<pre class="fragment"><code class="fsharp hljs" data-trim>					
let AddAmounts (x:int&lt'a&gt) (y:int&lt'a&gt) = 
    x + y
					</code></pre>
				</section>




				<section>
					<h1>Show me the code!</h1>
					<h2>Type inference</h2>
					<div style="float:left;width:50%;">
						<pre><code class="fsharp hljs" data-trim>	
namespace Parser

open System

module CommandLineParser = 
    let GetArgument prompt parser = 
        printf "%s" prompt
        Console.ReadLine() |> parser

    let GetInteger() = 
        GetArgument "Enter an integer: " Int32.Parse
						</code></pre>						
					</div>
					<div style="float:right;width:50%;">
						<pre><code class="hljs" data-trim>	
using System;

namespace Parser
{
    public class CommandLineParser
    {
        public static T GetArgument&ltT&gt(string prompt, Func&ltstring, T&gt parser)
        {
            Console.Write(prompt);
            return parser(Console.ReadLine());
        }

        public static int GetInteger()
        {
            return GetArgument("Enter an integer: ", int.Parse);
        }
    }
}
						</code></pre>						
					</div>
				</section>




				<section>
					<h1>Show me the code!</h1>
					<h2>Type Providers</h2>
					Infer the structure of a sample document and provide type-safe access
					<pre class="fragment"><code class="fsharp hljs" data-trim>	
open FSharp.Data

// Infer type from sample JSON
type Person = JsonProvider<""" { "name":"John", "age":94} """>

// Parse real input
let thomas = Person.Parse """ { "name":"Thomas", "age":14 } """
printfn "%s" thomas.Name
printfn "%i" thomas.Age      
					</code></pre>
					<pre class="fragment"><code class="fsharp hljs" data-trim>	
open FSharp.Data

type EntitlementUser = JsonProvider<""" [{"aqrUserId":"wallisd","userName":"Daniel Wallis","altName":"Daniel Wallis","department":"IT","group":"Enterprise Dev","hR_Id":56368,"aqrTitle":"Analyst","isManager":false,"manager":"Vitaliy Razhanskiy","managerId":"razhanskiyv","hireDate":"2016-04-11T00:00:00","employeeType":"Employee","adpGroupNumber":"71","email":"Daniel.Wallis@aqr.com","degree":null,"firstName":"Daniel","lastName":"Wallis"}] """>    

let PrintAllUsers() = 
    let url = "http://aqrweb/entitlementsystem/api/entitlement/GetHRUsers"    
    let rawJson = Http.RequestString(url, customizeHttpRequest = fun req -> req.UseDefaultCredentials <- true
                                                                            req)    
    EntitlementUser.Parse rawJson
    |> Seq.iter (fun user -> printfn "%s - %s" user.AqrUserId user.AltName)    					
					</code></pre>
					<div class="fragment">
					Type providers also exist for CSV, HTML, XML and WorldBank
					</div>
				</section>




				<section>
					<h1>Useful links</h1>
					<ul>
					<li><a href="https://fsharpforfunandprofit.com/">F# for fun and profit</a></li>
					<li><a href="http://fsharp.github.io/FSharp.Data/">F# Data</a></li>
					<li><a href="https://blogs.msdn.microsoft.com/dotnet/2016/12/13/project-springfield-a-cloud-service-built-entirely-in-f/">Project Springfield</a></li>
					</ul>
				</section>
			</div>
		</div>

		<script src="lib/js/head.min.js"></script>
		<script src="js/reveal.js"></script>

		<script>
			// More info https://github.com/hakimel/reveal.js#configuration
			Reveal.initialize({
				height:"100%",
				width:"75%",				
				history: true,

				// More info https://github.com/hakimel/reveal.js#dependencies
				dependencies: [
					{ src: 'plugin/markdown/marked.js' },
					{ src: 'plugin/markdown/markdown.js' },
					{ src: 'plugin/notes/notes.js', async: true },
					{ src: 'plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } }
				]
			});
		</script>
	</body>
</html>
